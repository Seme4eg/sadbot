#+title: sadbot documentation

- [[https://discord.com/developers/applications][discord applications page]]
- [[https://discord.com/api/oauth2/authorize?client_id=1104687184537190441&permissions=274881440832&scope=bot][bot invite link]]

** Deps
- yt-dlp (maybe replace with some [[https://github.com/iawia002/lux][go-based]] [[https://pkg.go.dev/search?q=youtube-dl&m=package][analogue]](s)?)
- cgo-git (AUR), *todo*: find opus driver without other deps?

Optional dependencies for yt-dlp
    ffmpeg: for video post-processing [installed]
    rtmpdump: for rtmp streams support
    atomicparsley: for embedding thumbnails into m4a files
    aria2: for using aria2 as external downloader
    python-mutagen: For embedding thumbnail in certain formats [installed]
    python-pycryptodomex: For decrypting AES-128 HLS streams and various other data
    python-websockets: For downloading over websocket

** Prototyping

- !play <title|URL> - require user in voice, join bot
- !history — Show recently played sounds.
- help        - shows all available commands
- info        - shows bot info and statistics

!save — Save current queue (within current bot session?)
!radio — Endless auto-generated radio based on selected genre.

pick ?
debug ?

** Todos
#+begin_src go
// logs errors to STDERR
var ErrLog = func(str string, err error) {
	prefix := "audio module: " + str
	if err != nil {
		os.Stderr.WriteString(prefix + ": " + err.Error())
	} else {
		os.Stderr.WriteString(prefix)
	}
}
#+end_src

- prev command
- skipto <index> command (based on those indexes in queue)
- [[https://github.com/yt-dlp/yt-dlp#usage-and-options][yt-dlp]]
- [[https://github.com/bwmarrin/discordgo/wiki/Awesome-DiscordGo][references]]
- Reply f-n now deletes prev message always, even if it's from prev session,
  which isn't a big deal, but is an unobvious behavious, subject for fix
- maybe add some more options to config? like how many tracks to show in queue?
- session sharding
- fix ~SendPCM error: Audio module error: PCM Channel closed~ log after each track
- make custom error interface for each package?
